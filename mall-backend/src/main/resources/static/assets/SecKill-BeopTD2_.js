import{f as P,g as I,o as N,c as R,w as n,a as F,e as t,j as y,s as C,E as g,k as f,r as i,_ as D,b as $,h as T,F as U,x as E,y as q,z}from"./index-BJIwiziA.js";const K={class:"dialog-footer"},M={__name:"DialogAddSecKill",props:{type:String,reload:Function},setup(V,{expose:h}){const d=V,o=P(null);C();const l=I({visible:!1,ruleForm:{goodsId:"",seckillPrice:"",seckillNum:"",seckillRank:"",seckillStatus:"",seckillBegin:"",seckillEnd:""},rules:{goodsId:[{required:"true",message:"商品编号不能为空",trigger:["change"]}],seckillPrice:[{required:"true",message:"秒杀价格不能为空",trigger:["change"]}],seckillNum:[{required:"true",message:"秒杀数量不能为空",trigger:["change"]}],seckillStatus:[{required:"true",message:"状态不能为空",trigger:["change"]}],seckillRank:[{required:"true",message:"编号不能为空",trigger:["change"]}],seckillBegin:[{required:"true",message:"开始时间不能为空",trigger:["change"]}],seckillEnd:[{required:"true",message:"结束时间不能为空",trigger:["change"]}]},id:""}),v=c=>{f.get(`/seckill/${c}`).then(e=>{console.log(e),l.ruleForm={goodsId:e.goodsId,seckillPrice:e.seckillPrice,seckillNum:e.seckillNum,seckillRank:e.seckillRank,seckillStatus:e.seckillStatus,seckillBegin:e.seckillBegin,seckillEnd:e.seckillEnd}})},B=c=>{l.visible=!0,c?(l.id=c,v(c)):l.ruleForm={goodsId:"",seckillPrice:"",seckillNum:"",seckillRank:"",seckillStatus:"",seckillBegin:"",seckillEnd:""}},x=()=>{l.visible=!1},w=()=>{o.value.validate(c=>{if(c){if(new Date(l.ruleForm.seckillBegin)>=new Date(l.ruleForm.seckillEnd)){g.error("开始时间必须小于结束时间");return}d.type=="add"?f.post("/seckill",{goodsId:l.ruleForm.goodsId,seckillPrice:l.ruleForm.seckillPrice,seckillNum:l.ruleForm.seckillNum,seckillRank:l.ruleForm.seckillRank,seckillStatus:l.ruleForm.seckillStatus,seckillBegin:p(l.ruleForm.seckillBegin),seckillEnd:p(l.ruleForm.seckillEnd)}).then(()=>{g.success("添加成功"),l.visible=!1,d.reload&&d.reload()}):f.put("/seckill",{seckillId:l.id,goodsId:l.ruleForm.goodsId,seckillPrice:l.ruleForm.seckillPrice,seckillNum:l.ruleForm.seckillNum,seckillRank:l.ruleForm.seckillRank,seckillStatus:l.ruleForm.seckillStatus,seckillBegin:p(l.ruleForm.seckillBegin),seckillEnd:p(l.ruleForm.seckillEnd)}).then(()=>{g.success("修改成功"),l.visible=!1,d.reload&&d.reload()})}})};function p(c){const e=new Date(c),r=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),m=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),k=String(e.getMinutes()).padStart(2,"0"),_=String(e.getSeconds()).padStart(2,"0");return`${r}-${u}-${m} ${a}:${k}:${_}`}return h({open:B,close:x}),(c,e)=>{const r=i("el-input"),u=i("el-form-item"),m=i("el-option"),a=i("el-select"),k=i("el-date-picker"),_=i("el-form"),b=i("el-button"),S=i("el-dialog");return N(),R(S,{title:V.type=="add"?"添加秒杀商品":"修改秒杀商品",modelValue:l.visible,"onUpdate:modelValue":e[8]||(e[8]=s=>l.visible=s),width:"400px"},{footer:n(()=>[F("span",K,[t(b,{onClick:e[7]||(e[7]=s=>l.visible=!1)},{default:n(()=>e[9]||(e[9]=[y("取 消")])),_:1}),t(b,{type:"primary",onClick:w},{default:n(()=>e[10]||(e[10]=[y("确 定")])),_:1})])]),default:n(()=>[t(_,{model:l.ruleForm,rules:l.rules,ref_key:"formRef",ref:o,"label-width":"100px",class:"good-form"},{default:n(()=>[t(u,{label:"商品编号",prop:"goodsId"},{default:n(()=>[t(r,{type:"text",modelValue:l.ruleForm.goodsId,"onUpdate:modelValue":e[0]||(e[0]=s=>l.ruleForm.goodsId=s)},null,8,["modelValue"])]),_:1}),t(u,{label:"秒杀价格",prop:"seckillPrice"},{default:n(()=>[t(r,{type:"text",modelValue:l.ruleForm.seckillPrice,"onUpdate:modelValue":e[1]||(e[1]=s=>l.ruleForm.seckillPrice=s)},null,8,["modelValue"])]),_:1}),t(u,{label:"秒杀数量",prop:"seckillNum"},{default:n(()=>[t(r,{type:"text",modelValue:l.ruleForm.seckillNum,"onUpdate:modelValue":e[2]||(e[2]=s=>l.ruleForm.seckillNum=s)},null,8,["modelValue"])]),_:1}),t(u,{label:"排序值",prop:"seckillRank"},{default:n(()=>[t(r,{type:"number",modelValue:l.ruleForm.seckillRank,"onUpdate:modelValue":e[3]||(e[3]=s=>l.ruleForm.seckillRank=s)},null,8,["modelValue"])]),_:1}),t(u,{label:"秒杀状态",prop:"seckillStatus"},{default:n(()=>[t(a,{modelValue:l.ruleForm.seckillStatus,"onUpdate:modelValue":e[4]||(e[4]=s=>l.ruleForm.seckillStatus=s),placeholder:"选择秒杀状态"},{default:n(()=>[t(m,{label:"开启",value:!0}),t(m,{label:"关闭",value:!1})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"开始时间",prop:"seckillBegin"},{default:n(()=>[t(k,{modelValue:l.ruleForm.seckillBegin,"onUpdate:modelValue":e[5]||(e[5]=s=>l.ruleForm.seckillBegin=s),type:"datetime",placeholder:"选择开始时间"},null,8,["modelValue"])]),_:1}),t(u,{label:"结束时间",prop:"seckillEnd"},{default:n(()=>[t(k,{modelValue:l.ruleForm.seckillEnd,"onUpdate:modelValue":e[6]||(e[6]=s=>l.ruleForm.seckillEnd=s),type:"datetime",placeholder:"选择结束时间"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},A={class:"header"},j=["onClick"],H={__name:"SecKill",setup(V){const h=P(null),d=P(null),o=I({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add"});$(()=>{l()});const l=()=>{o.loading=!0,f.get("/seckill/list",{params:{pageNumber:o.currentPage,pageSize:o.pageSize}}).then(e=>{o.tableData=e.list,o.total=e.totalCount,o.currentPage=e.currPage,o.loading=!1})},v=()=>{o.type="add",d.value.open()},B=e=>{o.type="edit",d.value.open(e)},x=e=>{o.multipleSelection=e},w=()=>{if(!o.multipleSelection.length){g.error("请选择项");return}f.delete("/seckill",{data:{ids:o.multipleSelection.map(e=>e.seckillId)}}).then(()=>{g.success("删除成功"),l()})},p=e=>{f.delete("/seckill",{data:{ids:[e]}}).then(()=>{g.success("删除成功"),l()})},c=e=>{o.currentPage=e,l()};return(e,r)=>{const u=i("el-button"),m=i("el-popconfirm"),a=i("el-table-column"),k=i("el-table"),_=i("el-pagination"),b=i("el-card");return N(),T(U,null,[t(b,{class:"index-container"},{header:n(()=>[F("div",A,[t(u,{type:"primary",icon:E(q),onClick:v},{default:n(()=>r[0]||(r[0]=[y("增加")])),_:1},8,["icon"]),t(m,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:w},{reference:n(()=>[t(u,{type:"danger",icon:E(z)},{default:n(()=>r[1]||(r[1]=[y("批量删除")])),_:1},8,["icon"])]),_:1})])]),default:n(()=>[t(k,{load:o.loading,ref_key:"multipleTable",ref:h,data:o.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:x},{default:n(()=>[t(a,{type:"selection",width:"55"}),t(a,{prop:"goodsId",label:"商品编号",width:"100"}),t(a,{prop:"seckillPrice",label:"秒杀价格",width:"100"}),t(a,{prop:"seckillNum",label:"秒杀数量",width:"100"}),t(a,{prop:"seckillBegin",label:"开始日期",width:"180"}),t(a,{prop:"seckillEnd",label:"截止日期",width:"180"}),t(a,{prop:"seckillStatus",label:"状态",width:"100"}),t(a,{prop:"seckillRank",label:"排序值",width:"100"}),t(a,{prop:"createTime",label:"添加时间",width:"180"}),t(a,{label:"操作",width:"120"},{default:n(S=>[F("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:s=>B(S.row.seckillId)},"修改",8,j),t(m,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:s=>p(S.row.seckillId)},{reference:n(()=>r[2]||(r[2]=[F("a",{style:{cursor:"pointer"}},"删除",-1)])),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["load","data"]),t(_,{background:"",layout:"prev, pager, next",total:o.total,"page-size":o.pageSize,"current-page":o.currentPage,onCurrentChange:c},null,8,["total","page-size","current-page"])]),_:1}),t(M,{ref_key:"addSeckill",ref:d,reload:l,type:o.type},null,8,["type"])],64)}}},O=D(H,[["__scopeId","data-v-f7a87ba8"]]);export{O as default};
