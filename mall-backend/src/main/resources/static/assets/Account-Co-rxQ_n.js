import{f,g as V,b,k as u,h as x,e as a,w as o,F as U,r as m,o as y,j as _,E as w}from"./index-BJIwiziA.js";import{m as F}from"./md5-D_LJMay6.js";const C={__name:"Account",setup(h){const d=f(null),i=f(null),e=V({user:null,nameForm:{loginName:"",nickName:""},passForm:{oldpass:"",newpass:""},rules:{loginName:[{required:"true",message:"登录名不能为空",trigger:["change"]}],nickName:[{required:"true",message:"昵称不能为空",trigger:["change"]}],oldpass:[{required:"true",message:"原密码不能为空",trigger:["change"]}],newpass:[{required:"true",message:"新密码不能为空",trigger:["change"]}]}});b(()=>{u.get("/adminUser/profile").then(s=>{e.user=s,e.nameForm.loginName=s.loginUserName,e.nameForm.nickName=s.nickName})});const N=()=>{d.value.validate(s=>{s&&u.put("/adminUser/name",{loginUserName:e.nameForm.loginName,nickName:e.nameForm.nickName}).then(()=>{w.success("修改成功"),window.location.reload()})})},k=()=>{i.value.validate(s=>{s&&u.put("/adminUser/password",{originalPassword:F(e.passForm.oldpass),newPassword:F(e.passForm.newpass)}).then(()=>{w.success("修改成功"),window.location.reload()})})};return(s,l)=>{const r=m("el-input"),t=m("el-form-item"),p=m("el-button"),c=m("el-form"),g=m("el-card");return y(),x(U,null,[a(g,{class:"account-container"},{default:o(()=>[a(c,{model:e.nameForm,rules:e.rules,ref_key:"nameRef",ref:d,"label-width":"80px","label-position":"right",class:"demo-ruleForm"},{default:o(()=>[a(t,{label:"登录名：",prop:"loginName"},{default:o(()=>[a(r,{style:{width:"200px"},modelValue:e.nameForm.loginName,"onUpdate:modelValue":l[0]||(l[0]=n=>e.nameForm.loginName=n)},null,8,["modelValue"])]),_:1}),a(t,{label:"昵称：",prop:"nickName"},{default:o(()=>[a(r,{style:{width:"200px"},modelValue:e.nameForm.nickName,"onUpdate:modelValue":l[1]||(l[1]=n=>e.nameForm.nickName=n)},null,8,["modelValue"])]),_:1}),a(t,null,{default:o(()=>[a(p,{type:"danger",onClick:N},{default:o(()=>l[4]||(l[4]=[_("确认修改")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),a(g,{class:"account-container"},{default:o(()=>[a(c,{model:e.passForm,rules:e.rules,ref_key:"passRef",ref:i,"label-width":"80px","label-position":"right",class:"demo-ruleForm"},{default:o(()=>[a(t,{label:"原密码：",prop:"oldpass"},{default:o(()=>[a(r,{style:{width:"200px"},modelValue:e.passForm.oldpass,"onUpdate:modelValue":l[2]||(l[2]=n=>e.passForm.oldpass=n)},null,8,["modelValue"])]),_:1}),a(t,{label:"新密码：",prop:"newpass"},{default:o(()=>[a(r,{style:{width:"200px"},modelValue:e.passForm.newpass,"onUpdate:modelValue":l[3]||(l[3]=n=>e.passForm.newpass=n)},null,8,["modelValue"])]),_:1}),a(t,null,{default:o(()=>[a(p,{type:"danger",onClick:k},{default:o(()=>l[5]||(l[5]=[_("确认修改")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})],64)}}};export{C as default};
