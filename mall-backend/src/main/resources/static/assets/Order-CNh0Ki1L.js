import{g as E,b as L,k as g,c,w as n,r as a,o as s,a as m,e as r,h as f,G as F,F as M,j as _,x as y,t as U,H as v,E as p,I as N,z as j}from"./index-BJIwiziA.js";const q={class:"header"},G={key:0},H={key:1},A={key:2},Q={__name:"Order",setup(J){const t=E({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,orderNo:"",orderStatus:"",options:[{value:"",label:"全部"},{value:0,label:"待支付"},{value:1,label:"已支付"},{value:2,label:"配货完成"},{value:3,label:"出库成功"},{value:4,label:"交易成功"},{value:-1,label:"手动关闭"},{value:-2,label:"超时关闭"},{value:-3,label:"商家关闭"}]});L(()=>{d()});const d=()=>{t.loading=!0,g.get("/orders",{params:{pageNumber:t.currentPage,pageSize:t.pageSize,orderNo:t.orderNo,orderStatus:t.orderStatus}}).then(l=>{console.log(l),t.tableData=l.list,t.total=l.totalCount,t.currentPage=l.currPage,t.loading=!1})},C=()=>{t.currentPage=1,d()},V=l=>{t.multipleSelection=l},P=l=>{t.currentPage=l,d()},k=l=>{let e;if(l)e=[l];else{if(!t.multipleSelection.length){console.log("state.multipleSelection",t.multipleSelection.length),p.error("请选择项");return}e=t.multipleSelection.map(i=>i.orderId)}g.put("/orders/checkDone",{ids:e}).then(()=>{p.success("配货成功"),d()})},x=l=>{let e;if(l)e=[l];else{if(!t.multipleSelection.length){p.error("请选择项");return}e=t.multipleSelection.map(i=>i.orderId)}g.put("/orders/checkOut",{ids:e}).then(()=>{p.success("出库成功"),d()})},h=l=>{let e;if(l)e=[l];else{if(!t.multipleSelection.length){p.error("请选择项");return}e=t.multipleSelection.map(i=>i.orderId)}g.put("/orders/close",{ids:e}).then(()=>{p.success("关闭成功"),d()})},I=l=>{const e=t.options.find(i=>i.value===l);return e?e.label:"未知状态"};return(l,e)=>{const i=a("el-input"),z=a("el-option"),$=a("el-select"),b=a("el-button"),u=a("el-table-column"),S=a("el-popconfirm"),D=a("router-link"),O=a("el-table"),T=a("el-pagination"),B=a("el-card");return s(),c(B,{class:"order-container"},{header:n(()=>[m("div",q,[r(i,{style:{width:"200px","margin-right":"10px"},placeholder:"请输入订单号",modelValue:t.orderNo,"onUpdate:modelValue":e[0]||(e[0]=o=>t.orderNo=o),onChange:C,clearable:""},null,8,["modelValue"]),r($,{onChange:C,modelValue:t.orderStatus,"onUpdate:modelValue":e[1]||(e[1]=o=>t.orderStatus=o),style:{width:"200px","margin-right":"10px"}},{default:n(()=>[(s(!0),f(M,null,F(t.options,o=>(s(),c(z,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),r(b,{type:"primary",icon:y(N),onClick:e[2]||(e[2]=o=>k())},{default:n(()=>e[5]||(e[5]=[_("配货完成")])),_:1},8,["icon"]),r(b,{type:"primary",icon:y(N),onClick:e[3]||(e[3]=o=>x())},{default:n(()=>e[6]||(e[6]=[_("出库")])),_:1},8,["icon"]),r(b,{type:"danger",icon:y(j),onClick:e[4]||(e[4]=o=>h())},{default:n(()=>e[7]||(e[7]=[_("关闭订单")])),_:1},8,["icon"])])]),default:n(()=>[r(O,{load:t.loading,data:t.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:V},{default:n(()=>[r(u,{type:"selection",width:"55"}),r(u,{prop:"orderNo",label:"订单号"}),r(u,{prop:"totalPrice",label:"订单总价"}),r(u,{prop:"orderStatus",label:"订单状态"},{default:n(o=>[m("span",null,U(I(o.row.orderStatus)),1)]),_:1}),r(u,{prop:"payType",label:"支付方式"},{default:n(o=>[o.row.payType==1?(s(),f("span",G,"微信支付")):o.row.payType==2?(s(),f("span",H,"支付宝支付")):(s(),f("span",A,"未知"))]),_:1}),r(u,{prop:"createTime",label:"创建时间"}),r(u,{label:"操作"},{default:n(o=>[o.row.orderStatus==1?(s(),c(S,{key:0,title:"确定配货完成吗？",onConfirm:w=>k(o.row.orderId),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:n(()=>e[8]||(e[8]=[m("a",{style:{cursor:"pointer","margin-right":"10px"}},"配货完成",-1)])),_:2},1032,["onConfirm"])):v("",!0),o.row.orderStatus==2?(s(),c(S,{key:1,title:"确定出库吗？",onConfirm:w=>x(o.row.orderId),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:n(()=>e[9]||(e[9]=[m("a",{style:{cursor:"pointer","margin-right":"10px"}},"出库",-1)])),_:2},1032,["onConfirm"])):v("",!0),o.row.orderStatus==4||o.row.orderStatus<0?v("",!0):(s(),c(S,{key:2,title:"确定关闭订单吗？",onConfirm:w=>h(o.row.orderId),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:n(()=>e[10]||(e[10]=[m("a",{style:{cursor:"pointer","margin-right":"10px"}},"关闭订单",-1)])),_:2},1032,["onConfirm"])),r(D,{to:{path:"/order_detail",query:{id:o.row.orderId}}},{default:n(()=>e[11]||(e[11]=[_("订单详情")])),_:2},1032,["to"])]),_:1})]),_:1},8,["load","data"]),r(T,{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.currentPage,onCurrentChange:P},null,8,["total","page-size","current-page"])]),_:1})}}};export{Q as default};
